{"version":3,"sources":["../src/common.js","../src/system-core.js","../src/baseurl.js","../src/features/script-load.js","../src/s.js"],"names":["envGlobal","self","global","backslashRegEx","hasSymbol","Symbol","toStringTag","REGISTRY","SystemJS","this","callResolve","loader","id","parentUrl","Promise","resolve","then","Error","catch","err","message","systemJSPrototype","prototype","lastRegister","import","parent","load","getOrCreateLoad","importerSetters","ns","Object","create","defineProperty","value","instantiatePromise","instantiate","registration","hoistedExports","declared","name","changed","p","i","length","createContext","undefined","e","execute","setters","n","I","L","instantiation","all","map","dep","setter","depId","depLoad","push","depLoads","d","eE","E","C","instantiateAll","loaded","postOrderExec","seen","depLoadPromises","forEach","depLoadPromise","evalError","doEval","execPromise","call","nullContext","done","topLevelLoad","parentId","meta","url","register","deps","declare","getRegister","_lastRegister","freeze","System","baseUrl","location","href","split","lastSepIndex","lastIndexOf","substr","reject","script","document","createElement","charset","async","addEventListener","head","removeChild","src","appendChild","relUrl","indexOf","replace","parentProtocol","pathname","segmented","output","segmentIndex","substring","pop","join","resolveIfNotPlainOrUrl"],"mappings":"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","sourcesContent":["export const hasSelf = typeof self !== 'undefined';\r\n\r\nconst envGlobal = hasSelf ? self : global;\r\nexport { envGlobal as global };\r\n\r\nconst backslashRegEx = /\\\\/g;\r\nexport function resolveIfNotPlainOrUrl (relUrl, parentUrl) {\r\n  if (relUrl.indexOf('\\\\') !== -1)\r\n    relUrl = relUrl.replace(backslashRegEx, '/');\r\n  // protocol-relative\r\n  if (relUrl[0] === '/' && relUrl[1] === '/') {\r\n    return parentUrl.substr(0, parentUrl.indexOf(':') + 1) + relUrl;\r\n  }\r\n  // relative-url\r\n  else if (relUrl[0] === '.' && (relUrl[1] === '/' || relUrl[1] === '.' && (relUrl[2] === '/' || relUrl.length === 2 && (relUrl += '/')) ||\r\n      relUrl.length === 1  && (relUrl += '/')) ||\r\n      relUrl[0] === '/') {\r\n    const parentProtocol = parentUrl.substr(0, parentUrl.indexOf(':') + 1);\r\n    // read pathname from parent URL\r\n    // pathname taken to be part after leading \"/\"\r\n    let pathname;\r\n    if (parentUrl[parentProtocol.length + 1] === '/') {\r\n      // resolving to a :// so we need to read out the auth and host\r\n      if (parentProtocol !== 'file:') {\r\n        pathname = parentUrl.substr(parentProtocol.length + 2);\r\n        pathname = pathname.substr(pathname.indexOf('/') + 1);\r\n      }\r\n      else {\r\n        pathname = parentUrl.substr(8);\r\n      }\r\n    }\r\n    else {\r\n      // resolving to :/ so pathname is the /... part\r\n      pathname = parentUrl.substr(parentProtocol.length + 1);\r\n    }\r\n\r\n    if (relUrl[0] === '/')\r\n      return parentUrl.substr(0, parentUrl.length - pathname.length - 1) + relUrl;\r\n\r\n    // join together and split for removal of .. and . segments\r\n    // looping the string instead of anything fancy for perf reasons\r\n    // '../../../../../z' resolved to 'x/y' is just 'z'\r\n    const segmented = pathname.substr(0, pathname.lastIndexOf('/') + 1) + relUrl;\r\n\r\n    const output = [];\r\n    let segmentIndex = -1;\r\n    for (let i = 0; i < segmented.length; i++) {\r\n      // busy reading a segment - only terminate on '/'\r\n      if (segmentIndex !== -1) {\r\n        if (segmented[i] === '/') {\r\n          output.push(segmented.substring(segmentIndex, i + 1));\r\n          segmentIndex = -1;\r\n        }\r\n      }\r\n\r\n      // new segment - check if it is relative\r\n      else if (segmented[i] === '.') {\r\n        // ../ segment\r\n        if (segmented[i + 1] === '.' && (segmented[i + 2] === '/' || i + 2 === segmented.length)) {\r\n          output.pop();\r\n          i += 2;\r\n        }\r\n        // ./ segment\r\n        else if (segmented[i + 1] === '/' || i + 1 === segmented.length) {\r\n          i += 1;\r\n        }\r\n        else {\r\n          // the start of a new segment as below\r\n          segmentIndex = i;\r\n        }\r\n      }\r\n      // it is the start of a new segment\r\n      else {\r\n        segmentIndex = i;\r\n      }\r\n    }\r\n    // finish reading out the last segment\r\n    if (segmentIndex !== -1)\r\n      output.push(segmented.substr(segmentIndex));\r\n    return parentUrl.substr(0, parentUrl.length - pathname.length) + output.join('');\r\n  }\r\n}","/*\r\n * SystemJS Core\r\n * \r\n * Provides\r\n * - System.import\r\n * - System.register support for\r\n *     live bindings, function hoisting through circular references,\r\n *     reexports, dynamic import, import.meta.url, top-level await\r\n * - System.getRegister to get the registration\r\n * - Symbol.toStringTag support in Module objects\r\n * - Hookable System.createContext to customize import.meta\r\n * - System.onload(id, err?) handler for tracing / hot-reloading\r\n * \r\n * Core comes with no System.prototype.resolve or\r\n * System.prototype.instantiate implementations\r\n */\r\nimport { global } from './common.js';\r\nexport { systemJSPrototype, REGISTRY }\r\n\r\nconst hasSymbol = typeof Symbol !== 'undefined';\r\nconst toStringTag = hasSymbol && Symbol.toStringTag;\r\nconst REGISTRY = hasSymbol ? Symbol() : '@';\r\n\r\nfunction SystemJS () {\r\n  this[REGISTRY] = {};\r\n}\r\n\r\nfunction callResolve (loader, id, parentUrl) {\r\n  return Promise.resolve()\r\n  .then(function () {\r\n    return loader.resolve(id, parentUrl);\r\n  })\r\n  .then(function (id) {\r\n    if (id)\r\n      return id;\r\n    throw new Error('No resolution');\r\n  })\r\n  .catch(function (err) {\r\n    err.message += '\\n  Resolving ' + id + (parentUrl ? ' to ' + parentUrl : '');\r\n    throw err;\r\n  });\r\n}\r\n\r\nconst systemJSPrototype = SystemJS.prototype;\r\nsystemJSPrototype.import = function (id, parent) {\r\n  const loader = this;\r\n  return callResolve(loader, id, parent)\r\n  .then(function (id) {\r\n    const load = getOrCreateLoad(loader, id);\r\n    return load.C || topLevelLoad(loader, load);\r\n  });\r\n};\r\n\r\n// Hookable createContext function -> allowing eg custom import meta\r\nsystemJSPrototype.createContext = function (parentId) {\r\n  const loader = this;\r\n  return {\r\n    import: function (id) {\r\n      return loader.import(id, parentId);\r\n    },\r\n    meta: {\r\n      url: parentId\r\n    }\r\n  };\r\n};\r\n\r\n// onLoad(id, err) provided for tracing / hot-reloading\r\nif (TRACING)\r\n  systemJSPrototype.onload = function () {};\r\nfunction onLoadHandler (loader, id, err) {\r\n  loader.onload(id, err);\r\n}\r\n\r\nlet lastRegister;\r\nsystemJSPrototype.register = function (deps, declare) {\r\n  lastRegister = [deps, declare];\r\n};\r\n\r\n/*\r\n * getRegister provides the last anonymous System.register call\r\n */\r\nsystemJSPrototype.getRegister = function () {\r\n  const _lastRegister = lastRegister;\r\n  lastRegister = undefined;\r\n  return _lastRegister;\r\n};\r\n\r\nfunction getOrCreateLoad (loader, id) {\r\n  let load = loader[REGISTRY][id];\r\n  if (load)\r\n    return load;\r\n\r\n  const importerSetters = [];\r\n  const ns = Object.create(null);\r\n  if (toStringTag)\r\n    Object.defineProperty(ns, toStringTag, { value: 'Module' });\r\n  \r\n  const instantiatePromise = Promise.resolve()\r\n  .then(function () {\r\n    return loader.instantiate(id);\r\n  })\r\n  .then(function (registration) {\r\n    if (!registration)\r\n      throw new Error('No System.register Module');\r\n    let hoistedExports = false;\r\n    function _export (name, value) {\r\n      hoistedExports = true;\r\n      let changed = false;\r\n      if (typeof name !== 'object') {\r\n        if (!(name in ns) || ns[name] !== value) {\r\n          ns[name] = value;\r\n          changed = true;\r\n        }\r\n      }\r\n      else {\r\n        for (let p in name) {\r\n          let value = name[p];\r\n          if (!(p in ns) || ns[p] !== value) {\r\n            ns[p] = value;\r\n            changed = true;\r\n          }\r\n        }\r\n      }\r\n      if (changed)\r\n        for (let i = 0; i < importerSetters.length; i++)\r\n          importerSetters[i](ns);\r\n      return value;\r\n    }\r\n    const declared = registration[1](_export, registration[1].length === 2 ? loader.createContext(id) : undefined);\r\n    load.e = declared.execute || function () {};\r\n    return [registration[0], declared.setters, hoistedExports];\r\n  })\r\n  .catch(function (err) {\r\n    err.message += '\\n  Instantiating ' + id;\r\n    load.e = null;\r\n    if (TRACING)\r\n      setTimeout(onLoadHandler, 0, loader, id, err);\r\n    throw err;\r\n  });\r\n\r\n  // Captial letter = a promise function\r\n  return load = loader[REGISTRY][id] = {\r\n    id: id,\r\n    // importerSetters, the setters functions registered to this dependency\r\n    // we retain this to add more later\r\n    i: importerSetters,\r\n    // module namespace object\r\n    n: ns,\r\n\r\n    // instantiate\r\n    I: instantiatePromise,\r\n    // link\r\n    L: instantiatePromise.then(function (instantiation) {\r\n      return Promise.all(instantiation[0].map(function (dep, i) {\r\n        const setter = instantiation[1][i];\r\n        return callResolve(loader, dep, id)\r\n        .then(function (depId) {\r\n          const depLoad = getOrCreateLoad(loader, depId);\r\n          // depLoad.I may be undefined for already-evaluated\r\n          return Promise.resolve(depLoad.I).then(function () {\r\n            if (setter) {\r\n              depLoad.i.push(setter);\r\n              // only run early setters when there are hoisted exports\r\n              if (instantiation[2] || !depLoad.I)\r\n                setter(depLoad.n);\r\n            }\r\n            return depLoad;\r\n          });\r\n        });\r\n      }))\r\n      .then(function (depLoads) {\r\n        load.d = depLoads;\r\n      });\r\n    }),\r\n\r\n    // On instantiate completion we have populated:\r\n    // dependency load records\r\n    d: undefined,\r\n    // execution function\r\n    // set to NULL immediately after execution (or on any failure) to indicate execution has happened\r\n    // in such a case, pC should be used, and pLo, pLi will be emptied\r\n    e: undefined,\r\n\r\n    // On execution we have populated:\r\n    // the execution error if any\r\n    eE: undefined,\r\n    // in the case of TLA, the execution promise\r\n    E: undefined,\r\n\r\n    // On execution, pLi, pLo, e cleared\r\n\r\n    // Promise for top-level completion\r\n    C: undefined\r\n  };\r\n}\r\n\r\nfunction instantiateAll (loader, load, loaded) {\r\n  if (!loaded[load.id]) {\r\n    loaded[load.id] = true;\r\n    // load.L may be undefined for already-instantiated\r\n    return Promise.resolve(load.L)\r\n    .then(function () {\r\n      return Promise.all(load.d.map(function (dep) {\r\n        return instantiateAll(loader, dep, loaded);\r\n      }));\r\n    });\r\n  }\r\n}\r\n\r\nfunction topLevelLoad (loader, load) {\r\n  return load.C = instantiateAll(loader, load, {})\r\n  .then(function () {\r\n    return postOrderExec(loader, load, {});\r\n  })\r\n  .then(function () {\r\n    return load.n;\r\n  });\r\n}\r\n\r\n// the closest we can get to call(undefined)\r\nconst nullContext = Object.freeze(Object.create(null));\r\n\r\n// returns a promise if and only if a top-level await subgraph\r\n// throws on sync errors\r\nfunction postOrderExec (loader, load, seen) {\r\n  if (!load.e) {\r\n    if (load.eE)\r\n      throw load.eE;\r\n    return load.E;\r\n  }\r\n\r\n  // deps execute first, unless circular\r\n  if (!seen[load.id]) {\r\n    seen[load.id] = true;\r\n    \r\n    let depLoadPromises;\r\n    load.d.forEach(function (depLoad) {\r\n      try {\r\n        const depLoadPromise = postOrderExec(loader, depLoad, seen);\r\n        if (depLoadPromise)\r\n          (depLoadPromises = depLoadPromises || []).push(depLoadPromise.catch(evalError));\r\n      }\r\n      catch (e) {\r\n        evalError(e);\r\n      }\r\n    });\r\n    if (depLoadPromises)\r\n      return Promise.all(depLoadPromises).then(doEval);\r\n  }\r\n\r\n  return doEval();\r\n\r\n  function doEval () {\r\n    // could be circular or tla\r\n    if (!load.e)\r\n      return load.E;\r\n  \r\n    try {\r\n      const execPromise = load.e.call(nullContext);\r\n      if (execPromise)\r\n        return load.E = execPromise.then(done, evalError);\r\n      done();\r\n    }\r\n    catch (err) {\r\n      evalError(err);\r\n    }\r\n    finally {\r\n      load.L = load.I = undefined;\r\n      load.e = null;\r\n    }\r\n  }\r\n\r\n  function done () {\r\n    // (should be a promise, but a minify optimization to leave out Promise.resolve)\r\n    load.C = load.n;\r\n    if (TRACING)\r\n      setTimeout(onLoadHandler, 0, loader, load.id);\r\n  }\r\n  \r\n  function evalError (err) {\r\n    err.message += '\\n  Evaluating ' + load.id;\r\n    if (!load.eE)\r\n      load.eE = err;\r\n    if (TRACING)\r\n      setTimeout(onLoadHandler, 0, loader, load.id, err);\r\n    throw err;\r\n  }\r\n}\r\n\r\nglobal.System = new SystemJS();","export let baseUrl = location.href.split('#')[0].split('?')[0];\r\nconst lastSepIndex = baseUrl.lastIndexOf('/');\r\nif (lastSepIndex !== -1)\r\n  baseUrl = baseUrl.substr(0, lastSepIndex + 1);","import { systemJSPrototype } from '../system-core';\r\n\r\n/*\r\n * Supports loading System.register via script tag injection\r\n */\r\nsystemJSPrototype.instantiate = function (url) {\r\n  const loader = this;\r\n  return new Promise((resolve, reject) => {\r\n    const script = document.createElement('script');\r\n    script.charset = 'utf-8';\r\n    script.async = true;\r\n    script.addEventListener('error', reject);\r\n    script.addEventListener('load', function () {\r\n      resolve(loader.getRegister());\r\n      document.head.removeChild(script);\r\n    });\r\n    script.src = url;\r\n    document.head.appendChild(script);\r\n  });\r\n};","import { systemJSPrototype } from './system-core.js';\r\nimport { baseUrl } from './baseurl.js';\r\nimport { resolveIfNotPlainOrUrl } from './common.js';\r\nimport './features/script-load.js';\r\n\r\nsystemJSPrototype.resolve = function (id, parent) {\r\n  return resolveIfNotPlainOrUrl(id, parent || baseUrl);\r\n};"]}