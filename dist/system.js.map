{"version":3,"sources":["../src/common.js","../src/system-core.js","../src/features/global.js","../src/features/script-load.js","../src/features/worker-load.js","../src/features/wasm-load.js","../src/baseurl.js","../src/features/package-name-map.js","../src/features/registry.js"],"names":["hasSelf","self","envGlobal","global","backslashRegEx","resolveIfNotPlainOrUrl","relUrl","parentUrl","indexOf","replace","substr","length","parentProtocol","pathname","segmented","lastIndexOf","output","segmentIndex","i","push","substring","pop","join","hasSymbol","Symbol","toStringTag","REGISTRY","SystemJS","this","callResolve","loader","id","Promise","resolve","then","Error","catch","err","message","systemJSPrototype","prototype","onLoadHandler","onload","lastRegister","import","parent","load","getOrCreateLoad","importerSetters","ns","Object","create","defineProperty","value","instantiatePromise","instantiate","registration","hoistedExports","declared","name","changed","p","createContext","undefined","e","execute","setters","setTimeout","n","I","L","instantiation","all","map","dep","setter","depId","depLoad","depLoads","d","eE","E","C","instantiateAll","loaded","postOrderExec","seen","depLoadPromises","forEach","depLoadPromise","evalError","doEval","execPromise","call","nullContext","done","topLevelLoad","parentId","meta","url","register","deps","declare","getRegister","_lastRegister","freeze","lastGlobalProp","System","reject","script","document","createElement","charset","async","addEventListener","head","removeChild","src","appendChild","importScripts","execInstantiate","lastGlobalCheck","now","Date","keys","globalProp","globalExport","_export","endsWith","fetch","res","ok","status","statusText","WebAssembly","compileStreaming","module","importObj","Module","imports","impt","key","m","Instance","exports","baseUrl","location","href","split","lastSepIndex","packageMapPromise","packageMapResolve","scripts","getElementsByTagName","type","json","createPackageMap","JSON","parse","innerHTML","resolveUrl","startsWith","path_prefix","pageBaseUrl","basePackages","packages","scopePackages","scopes","scopeName","scope","getMatch","matchObj","sepIndex","segmnet","applyPackages","pkgName","pkg","main","path","packageResolution","resolvedIfNotPlainOrUrl","get","pE","delete"],"mappings":"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","sourcesContent":["export const hasSelf = typeof self !== 'undefined';\r\n\r\nconst envGlobal = hasSelf ? self : global;\r\nexport { envGlobal as global };\r\n\r\nconst backslashRegEx = /\\\\/g;\r\nexport function resolveIfNotPlainOrUrl (relUrl, parentUrl) {\r\n  if (relUrl.indexOf('\\\\') !== -1)\r\n    relUrl = relUrl.replace(backslashRegEx, '/');\r\n  // protocol-relative\r\n  if (relUrl[0] === '/' && relUrl[1] === '/') {\r\n    return parentUrl.substr(0, parentUrl.indexOf(':') + 1) + relUrl;\r\n  }\r\n  // relative-url\r\n  else if (relUrl[0] === '.' && (relUrl[1] === '/' || relUrl[1] === '.' && (relUrl[2] === '/' || relUrl.length === 2 && (relUrl += '/')) ||\r\n      relUrl.length === 1  && (relUrl += '/')) ||\r\n      relUrl[0] === '/') {\r\n    const parentProtocol = parentUrl.substr(0, parentUrl.indexOf(':') + 1);\r\n    // read pathname from parent URL\r\n    // pathname taken to be part after leading \"/\"\r\n    let pathname;\r\n    if (parentUrl[parentProtocol.length + 1] === '/') {\r\n      // resolving to a :// so we need to read out the auth and host\r\n      if (parentProtocol !== 'file:') {\r\n        pathname = parentUrl.substr(parentProtocol.length + 2);\r\n        pathname = pathname.substr(pathname.indexOf('/') + 1);\r\n      }\r\n      else {\r\n        pathname = parentUrl.substr(8);\r\n      }\r\n    }\r\n    else {\r\n      // resolving to :/ so pathname is the /... part\r\n      pathname = parentUrl.substr(parentProtocol.length + 1);\r\n    }\r\n\r\n    if (relUrl[0] === '/')\r\n      return parentUrl.substr(0, parentUrl.length - pathname.length - 1) + relUrl;\r\n\r\n    // join together and split for removal of .. and . segments\r\n    // looping the string instead of anything fancy for perf reasons\r\n    // '../../../../../z' resolved to 'x/y' is just 'z'\r\n    const segmented = pathname.substr(0, pathname.lastIndexOf('/') + 1) + relUrl;\r\n\r\n    const output = [];\r\n    let segmentIndex = -1;\r\n    for (let i = 0; i < segmented.length; i++) {\r\n      // busy reading a segment - only terminate on '/'\r\n      if (segmentIndex !== -1) {\r\n        if (segmented[i] === '/') {\r\n          output.push(segmented.substring(segmentIndex, i + 1));\r\n          segmentIndex = -1;\r\n        }\r\n      }\r\n\r\n      // new segment - check if it is relative\r\n      else if (segmented[i] === '.') {\r\n        // ../ segment\r\n        if (segmented[i + 1] === '.' && (segmented[i + 2] === '/' || i + 2 === segmented.length)) {\r\n          output.pop();\r\n          i += 2;\r\n        }\r\n        // ./ segment\r\n        else if (segmented[i + 1] === '/' || i + 1 === segmented.length) {\r\n          i += 1;\r\n        }\r\n        else {\r\n          // the start of a new segment as below\r\n          segmentIndex = i;\r\n        }\r\n      }\r\n      // it is the start of a new segment\r\n      else {\r\n        segmentIndex = i;\r\n      }\r\n    }\r\n    // finish reading out the last segment\r\n    if (segmentIndex !== -1)\r\n      output.push(segmented.substr(segmentIndex));\r\n    return parentUrl.substr(0, parentUrl.length - pathname.length) + output.join('');\r\n  }\r\n}","/*\r\n * SystemJS Core\r\n * \r\n * Provides\r\n * - System.import\r\n * - System.register support for\r\n *     live bindings, function hoisting through circular references,\r\n *     reexports, dynamic import, import.meta.url, top-level await\r\n * - System.getRegister to get the registration\r\n * - Symbol.toStringTag support in Module objects\r\n * - Hookable System.createContext to customize import.meta\r\n * - System.onload(id, err?) handler for tracing / hot-reloading\r\n * \r\n * Core comes with no System.prototype.resolve or\r\n * System.prototype.instantiate implementations\r\n */\r\nimport { global } from './common.js';\r\nexport { systemJSPrototype, REGISTRY }\r\n\r\nconst hasSymbol = typeof Symbol !== 'undefined';\r\nconst toStringTag = hasSymbol && Symbol.toStringTag;\r\nconst REGISTRY = hasSymbol ? Symbol() : '@';\r\n\r\nfunction SystemJS () {\r\n  this[REGISTRY] = {};\r\n}\r\n\r\nfunction callResolve (loader, id, parentUrl) {\r\n  return Promise.resolve()\r\n  .then(function () {\r\n    return loader.resolve(id, parentUrl);\r\n  })\r\n  .then(function (id) {\r\n    if (id)\r\n      return id;\r\n    throw new Error('No resolution');\r\n  })\r\n  .catch(function (err) {\r\n    err.message += '\\n  Resolving ' + id + (parentUrl ? ' to ' + parentUrl : '');\r\n    throw err;\r\n  });\r\n}\r\n\r\nconst systemJSPrototype = SystemJS.prototype;\r\nsystemJSPrototype.import = function (id, parent) {\r\n  const loader = this;\r\n  return callResolve(loader, id, parent)\r\n  .then(function (id) {\r\n    const load = getOrCreateLoad(loader, id);\r\n    return load.C || topLevelLoad(loader, load);\r\n  });\r\n};\r\n\r\n// Hookable createContext function -> allowing eg custom import meta\r\nsystemJSPrototype.createContext = function (parentId) {\r\n  const loader = this;\r\n  return {\r\n    import: function (id) {\r\n      return loader.import(id, parentId);\r\n    },\r\n    meta: {\r\n      url: parentId\r\n    }\r\n  };\r\n};\r\n\r\n// onLoad(id, err) provided for tracing / hot-reloading\r\nif (TRACING)\r\n  systemJSPrototype.onload = function () {};\r\nfunction onLoadHandler (loader, id, err) {\r\n  loader.onload(id, err);\r\n}\r\n\r\nlet lastRegister;\r\nsystemJSPrototype.register = function (deps, declare) {\r\n  lastRegister = [deps, declare];\r\n};\r\n\r\n/*\r\n * getRegister provides the last anonymous System.register call\r\n */\r\nsystemJSPrototype.getRegister = function () {\r\n  const _lastRegister = lastRegister;\r\n  lastRegister = undefined;\r\n  return _lastRegister;\r\n};\r\n\r\nfunction getOrCreateLoad (loader, id) {\r\n  let load = loader[REGISTRY][id];\r\n  if (load)\r\n    return load;\r\n\r\n  const importerSetters = [];\r\n  const ns = Object.create(null);\r\n  if (toStringTag)\r\n    Object.defineProperty(ns, toStringTag, { value: 'Module' });\r\n  \r\n  const instantiatePromise = Promise.resolve()\r\n  .then(function () {\r\n    return loader.instantiate(id);\r\n  })\r\n  .then(function (registration) {\r\n    if (!registration)\r\n      throw new Error('No System.register Module');\r\n    let hoistedExports = false;\r\n    function _export (name, value) {\r\n      hoistedExports = true;\r\n      let changed = false;\r\n      if (typeof name !== 'object') {\r\n        if (!(name in ns) || ns[name] !== value) {\r\n          ns[name] = value;\r\n          changed = true;\r\n        }\r\n      }\r\n      else {\r\n        for (let p in name) {\r\n          let value = name[p];\r\n          if (!(p in ns) || ns[p] !== value) {\r\n            ns[p] = value;\r\n            changed = true;\r\n          }\r\n        }\r\n      }\r\n      if (changed)\r\n        for (let i = 0; i < importerSetters.length; i++)\r\n          importerSetters[i](ns);\r\n      return value;\r\n    }\r\n    const declared = registration[1](_export, registration[1].length === 2 ? loader.createContext(id) : undefined);\r\n    load.e = declared.execute || function () {};\r\n    return [registration[0], declared.setters, hoistedExports];\r\n  })\r\n  .catch(function (err) {\r\n    err.message += '\\n  Instantiating ' + id;\r\n    load.e = null;\r\n    if (TRACING)\r\n      setTimeout(onLoadHandler, 0, loader, id, err);\r\n    throw err;\r\n  });\r\n\r\n  // Captial letter = a promise function\r\n  return load = loader[REGISTRY][id] = {\r\n    id: id,\r\n    // importerSetters, the setters functions registered to this dependency\r\n    // we retain this to add more later\r\n    i: importerSetters,\r\n    // module namespace object\r\n    n: ns,\r\n\r\n    // instantiate\r\n    I: instantiatePromise,\r\n    // link\r\n    L: instantiatePromise.then(function (instantiation) {\r\n      return Promise.all(instantiation[0].map(function (dep, i) {\r\n        const setter = instantiation[1][i];\r\n        return callResolve(loader, dep, id)\r\n        .then(function (depId) {\r\n          const depLoad = getOrCreateLoad(loader, depId);\r\n          // depLoad.I may be undefined for already-evaluated\r\n          return Promise.resolve(depLoad.I).then(function () {\r\n            if (setter) {\r\n              depLoad.i.push(setter);\r\n              // only run early setters when there are hoisted exports\r\n              if (instantiation[2] || !depLoad.I)\r\n                setter(depLoad.n);\r\n            }\r\n            return depLoad;\r\n          });\r\n        });\r\n      }))\r\n      .then(function (depLoads) {\r\n        load.d = depLoads;\r\n      });\r\n    }),\r\n\r\n    // On instantiate completion we have populated:\r\n    // dependency load records\r\n    d: undefined,\r\n    // execution function\r\n    // set to NULL immediately after execution (or on any failure) to indicate execution has happened\r\n    // in such a case, pC should be used, and pLo, pLi will be emptied\r\n    e: undefined,\r\n\r\n    // On execution we have populated:\r\n    // the execution error if any\r\n    eE: undefined,\r\n    // in the case of TLA, the execution promise\r\n    E: undefined,\r\n\r\n    // On execution, pLi, pLo, e cleared\r\n\r\n    // Promise for top-level completion\r\n    C: undefined\r\n  };\r\n}\r\n\r\nfunction instantiateAll (loader, load, loaded) {\r\n  if (!loaded[load.id]) {\r\n    loaded[load.id] = true;\r\n    // load.L may be undefined for already-instantiated\r\n    return Promise.resolve(load.L)\r\n    .then(function () {\r\n      return Promise.all(load.d.map(function (dep) {\r\n        return instantiateAll(loader, dep, loaded);\r\n      }));\r\n    });\r\n  }\r\n}\r\n\r\nfunction topLevelLoad (loader, load) {\r\n  return load.C = instantiateAll(loader, load, {})\r\n  .then(function () {\r\n    return postOrderExec(loader, load, {});\r\n  })\r\n  .then(function () {\r\n    return load.n;\r\n  });\r\n}\r\n\r\n// the closest we can get to call(undefined)\r\nconst nullContext = Object.freeze(Object.create(null));\r\n\r\n// returns a promise if and only if a top-level await subgraph\r\n// throws on sync errors\r\nfunction postOrderExec (loader, load, seen) {\r\n  if (!load.e) {\r\n    if (load.eE)\r\n      throw load.eE;\r\n    return load.E;\r\n  }\r\n\r\n  // deps execute first, unless circular\r\n  if (!seen[load.id]) {\r\n    seen[load.id] = true;\r\n    \r\n    let depLoadPromises;\r\n    load.d.forEach(function (depLoad) {\r\n      try {\r\n        const depLoadPromise = postOrderExec(loader, depLoad, seen);\r\n        if (depLoadPromise)\r\n          (depLoadPromises = depLoadPromises || []).push(depLoadPromise.catch(evalError));\r\n      }\r\n      catch (e) {\r\n        evalError(e);\r\n      }\r\n    });\r\n    if (depLoadPromises)\r\n      return Promise.all(depLoadPromises).then(doEval);\r\n  }\r\n\r\n  return doEval();\r\n\r\n  function doEval () {\r\n    // could be circular or tla\r\n    if (!load.e)\r\n      return load.E;\r\n  \r\n    try {\r\n      const execPromise = load.e.call(nullContext);\r\n      if (execPromise)\r\n        return load.E = execPromise.then(done, evalError);\r\n      done();\r\n    }\r\n    catch (err) {\r\n      evalError(err);\r\n    }\r\n    finally {\r\n      load.L = load.I = undefined;\r\n      load.e = null;\r\n    }\r\n  }\r\n\r\n  function done () {\r\n    // (should be a promise, but a minify optimization to leave out Promise.resolve)\r\n    load.C = load.n;\r\n    if (TRACING)\r\n      setTimeout(onLoadHandler, 0, loader, load.id);\r\n  }\r\n  \r\n  function evalError (err) {\r\n    err.message += '\\n  Evaluating ' + load.id;\r\n    if (!load.eE)\r\n      load.eE = err;\r\n    if (TRACING)\r\n      setTimeout(onLoadHandler, 0, loader, load.id, err);\r\n    throw err;\r\n  }\r\n}\r\n\r\nglobal.System = new SystemJS();","/*\r\n * Support for global loading\r\n */\r\nimport { global } from '../common.js';\r\nimport { systemJSPrototype } from '../system-core';\r\n\r\nlet lastGlobalProp;\r\nlet lastGlobalCheck = -1;\r\nconst instantiate = systemJSPrototype.instantiate;\r\nsystemJSPrototype.instantiate = function (url) {\r\n  // note the last defined global, debounced every 50ms\r\n  const now = Date.now();\r\n  if (now - lastGlobalCheck > 50) {\r\n    lastGlobalProp = Object.keys(global).pop();\r\n    lastGlobalCheck = now;\r\n  }\r\n  return instantiate.call(this, url);\r\n};\r\n\r\nconst getRegister = systemJSPrototype.getRegister;\r\nsystemJSPrototype.getRegister = function () {\r\n  const lastRegister = getRegister.call(this);\r\n  if (lastRegister)\r\n    return lastRegister;\r\n  \r\n  // no registration -> attempt a global detection\r\n  // we take the global value to be the last defined new global object property\r\n  // if the property already existed as undefined, then no global is detected\r\n  const globalProp = Object.keys(global).pop();\r\n  lastGlobalCheck = Date.now();\r\n  if (lastGlobalProp === globalProp)\r\n    return;\r\n  \r\n  lastGlobalProp = globalProp;\r\n  let globalExport;\r\n  try {\r\n    globalExport = global[globalProp];\r\n  }\r\n  catch (e) {\r\n    return;\r\n  }\r\n\r\n  return [[], function (_export) {\r\n    return { execute: function () { _export('default', globalExport) } };\r\n  }];  \r\n};","import { systemJSPrototype } from '../system-core';\r\n\r\n/*\r\n * Supports loading System.register via script tag injection\r\n */\r\nsystemJSPrototype.instantiate = function (url) {\r\n  const loader = this;\r\n  return new Promise((resolve, reject) => {\r\n    const script = document.createElement('script');\r\n    script.charset = 'utf-8';\r\n    script.async = true;\r\n    script.addEventListener('error', reject);\r\n    script.addEventListener('load', function () {\r\n      resolve(loader.getRegister());\r\n      document.head.removeChild(script);\r\n    });\r\n    script.src = url;\r\n    document.head.appendChild(script);\r\n  });\r\n};","/*\r\n * Supports loading System.register in workers\r\n */\r\nimport { systemJSPrototype } from '../system-core';\r\nimport { hasSelf } from '../common';\r\n\r\nif (hasSelf && typeof importScripts === 'function')\r\n  systemJSPrototype.instantiate = function (url) {\r\n    const loader = this;\r\n    return new Promise(function (resolve, reject) {\r\n      try {\r\n        importScripts(url);\r\n      }\r\n      catch (e) {\r\n        reject(e);\r\n      }\r\n      resolve(loader.execInstantiate());\r\n    });\r\n  };","/*\r\n * Loads WASM based on file extension detection\r\n * Assumes successive instantiate will handle other files\r\n */\r\nimport { systemJSPrototype } from '../system-core';\r\nconst instantiate = systemJSPrototype.instantiate;\r\nsystemJSPrototype.instantiate = function (url) {\r\n  if (!url.endsWith('.wasm'))\r\n    return instantiate.call(this, url);\r\n  \r\n  return fetch(url)\r\n  .then(function (res) {\r\n    if (!res.ok)\r\n      throw new Error('Fetch error: ' + res.status + ' ' + res.statusText);\r\n    return WebAssembly.compileStreaming(res);\r\n  })\r\n  .then(function (module) {\r\n    const deps = [];\r\n    const setters = [];\r\n    const importObj = {};\r\n\r\n    // we can only set imports if supported (eg early Safari doesnt support)\r\n    if (WebAssembly.Module.imports)\r\n      WebAssembly.Module.imports(module).forEach(function (impt) {\r\n        const key = impt.module;\r\n        setters.push(function (m) {\r\n          importObj[key] = m;\r\n        });\r\n        if (deps.indexOf(key) === -1)\r\n          deps.push(key);\r\n      });\r\n\r\n    return [deps, function (_export) {\r\n      return {\r\n        setters: setters,\r\n        execute: function () {\r\n          _export(new WebAssembly.Instance(module, importObj).exports);\r\n        }\r\n      };\r\n    }];\r\n  });\r\n};","export let baseUrl = location.href.split('#')[0].split('?')[0];\r\nconst lastSepIndex = baseUrl.lastIndexOf('/');\r\nif (lastSepIndex !== -1)\r\n  baseUrl = baseUrl.substr(0, lastSepIndex + 1);","/*\r\n * Package name map support for SystemJS\r\n * \r\n * <script type=\"systemjs-packagemap\">{}</script>\r\n * OR\r\n * <script type=\"systemjs-packagemap\" src=package.json></script>\r\n * \r\n * Only supports loading the first package map\r\n */\r\nimport { resolveIfNotPlainOrUrl } from '../common.js';\r\nimport { systemJSPrototype } from '../system-core.js';\r\nimport { baseUrl as pageBaseUrl } from '../baseurl.js';\r\n\r\nlet packageMapPromise, packageMapResolve;\r\nconst scripts = document.getElementsByTagName('script');\r\nfor (let i = 0; i < scripts.length; i++) {\r\n  const script = scripts[i];\r\n  if (script.type !== 'systemjs-packagemap')\r\n    continue;\r\n\r\n  if (!script.src)\r\n    packageMapResolve = createPackageMap(JSON.parse(script.innerHTML));\r\n  else\r\n    packageMapPromise = fetch(script.src)\r\n    .then(function (res) {\r\n      return res.json();\r\n    })\r\n    .then(function (json) {\r\n      packageMapResolve = createPackageMap(json);\r\n      packageMapPromise = undefined;\r\n    });\r\n  break;\r\n}\r\n\r\nsystemJSPrototype.resolve = function (id, parentUrl) {\r\n  const resolvedIfNotPlainOrUrl = resolveIfNotPlainOrUrl(id, parentUrl || pageBaseUrl);\r\n  if (resolvedIfNotPlainOrUrl)\r\n    return resolvedIfNotPlainOrUrl;\r\n\r\n  if (packageMapResolve)\r\n    return packageMapResolve(id, parentUrl);\r\n\r\n  if (packageMapPromise)\r\n    return packageMapPromise\r\n    .then(function () {\r\n      return packageMapResolve(id, parentUrl);\r\n    });\r\n  \r\n  return id;\r\n};\r\n\r\n/*\r\n * Package name maps implementation\r\n *\r\n * Reduced implementation - only a single scope level is supported\r\n * \r\n * To make lookups fast we pre-resolve the entire package name map\r\n * and then match based on backtracked hash lookups\r\n * \r\n * path_prefix in scopes not supported\r\n * nested scopes not supported\r\n */\r\n\r\nfunction resolveUrl (relUrl, parentUrl) {\r\n  return resolveIfNotPlainOrUrl(relUrl.startsWith('./') ? relUrl : './' + json.path_prefix, parentUrl);\r\n}\r\n\r\nfunction createPackageMap (json) {\r\n  let baseUrl = json.path_prefix ? resolveUrl(json.path_prefix, pageBaseUrl) : pageBaseUrl;\r\n  if (baseUrl[baseUrl.length - 1] !== '/')\r\n    baseUrl += '/';\r\n    \r\n  const basePackages = json.packages || {};\r\n  const scopePackages = {};\r\n  if (json.scopes) {\r\n    for (let scopeName in json.scopes) {\r\n      const scope = json.scopes[scopeName];\r\n      if (scope.path_prefix)\r\n        throw new Error('Scope path_prefix not currently supported');\r\n      if (scope.scopes)\r\n        throw new Error('Nested scopes not currently supported');\r\n      scopePackages[resolveUrl(scopeName, baseUrl)] = scope.packages || {};\r\n    }\r\n  }\r\n\r\n  function getMatch (url, matchObj) {\r\n    let sepIndex = url.length;\r\n    while ((sepIndex = url.lastIndexOf('/', sepIndex)) !== -1) {\r\n      const segment = url.substr(0, sepIndex);\r\n      if (segment in matchObj)\r\n        return segmnet;\r\n    }\r\n  }\r\n\r\n  function applyPackages (id, packages) {\r\n    const pkgName = getMatch(id, packages);\r\n    if (pkgName) {\r\n      const pkg = packages[pkgName];\r\n      if (pkg === id) {\r\n        if (typeof pkg === 'string')\r\n          return resolveUrl(pkgName + '/' + pkg, baseUrl);\r\n        if (!pkg.main)\r\n          throw new Error('Package ' + pkgName + ' has no main');\r\n        return resolveUrl((pkg.path || pkgName) + '/' + pkg.main, baseUrl);\r\n      }\r\n      return resolveUrl((pkg.path || pkgName) + '/' + id.substr(pkg.length), baseUrl);\r\n    }\r\n  }\r\n\r\n  return function (id, parentUrl) {\r\n    const scope = getMatch(parentUrl, scopePackages);\r\n    if (scope) {\r\n      const packages = scopePackages[scope];\r\n      const packageResolution = applyPackages(id, packages);\r\n      if (packageResolution)\r\n        return packageResolution;\r\n    }\r\n    // core will throw \"No resolution\" on blank resolution\r\n    return applyPackages(id, basePackages);\r\n  };\r\n}\r\n","import { systemJSPrototype, REGISTRY } from '../system-core.js';\r\n\r\nsystemJSPrototype.get = function (id) {\r\n  const load = this[REGISTRY][id];\r\n  if (load && load.e === null && !load.pE)\r\n    return load.ns;\r\n};\r\n\r\n// Delete function provided for hot-reloading use cases\r\nsystemJSPrototype.delete = function (id) {\r\n  return this.get(id) ? delete this[REGISTRY][id] : false;\r\n};"]}